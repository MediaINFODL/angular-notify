angular.module("cgNotify",["ngSanitize"]).factory("notify",["$timeout","$http","$compile","$templateCache","$rootScope","$sce",function(q,r,n,d,e,i){var b=10;var l=15;var a=10000;var k="angular-notify.html";var s="";var h=document.body;var o="";var m=false;var p=false;var c=false;var f=false;var j=[];var g=function(t){if(typeof t!=="object"){t={message:t}}t.templateUrl=t.templateUrl?t.templateUrl:k;t.position=t.position?t.position:s;t.container=t.container?t.container:h;t.classes=t.classes?t.classes:o;t.persistent=t.persistent?t.persistent:m;t.duration=t.duration?t.duration:a;t.startTop=t.startTop?t.startTop:b;t.single=t.single?t.single:p;t.closable=t.closable?t.closable:c;t.toggleable=t.toggleable?t.toggleable:f;if(t.single){t.classes+=" ns-single"}var u=t.scope?t.scope.$new():e.$new();u.$message=t.message;u.$classes=t.classes;u.$messageTemplate=t.messageTemplate;u.$persistent=t.persistent;u.$closable=t.closable;u.$toggleable=t.toggleable;u.$state=false;r.get(t.templateUrl,{cache:d}).success(function(y){var z=n(y)(u);z.bind("webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",function(B){if(B.propertyName==="opacity"||(B.originalEvent&&B.originalEvent.propertyName==="opacity")){z.remove();if(!t.single){j.splice(j.indexOf(z),1);A()}}});if(t.messageTemplate){var w;for(var x=0;x<z.children().length;x++){if(angular.element(z.children()[x]).hasClass("cg-notify-message-template")){w=angular.element(z.children()[x]);break}}if(w){w.append(n(t.messageTemplate)(u))}else{throw new Error("cgNotify could not find the .cg-notify-message-template element in "+t.templateUrl+".")}}angular.element(t.container).append(z);if(z.hasClass("ns-effect-slide")&&z.hasClass("ns-bottomright")){z.css({bottom:"-"+z.outerHeight()+"px"})}u.$state=true;if(!t.single){j.push(z);if(t.position==="center"){q(function(){z.css("margin-left","-"+(z[0].offsetWidth/2)+"px")})}}u.$close=function(){if(!t.toggleable){if(z.hasClass("ns-effect-slide")&&z.hasClass("ns-bottomright")){z.css({bottom:"-"+z.outerHeight()+"px"})}else{z.css("opacity",0).attr("data-closing","true")}z.removeClass("ns-show").addClass("ns-hide");u.$state=false;q(function(){z.remove();if(!t.single){j.splice(j.indexOf(z),1);$("body").addClass("notice-box-closing");setTimeout(function(){$("body").removeClass("notice-box-closing")},250);A()}},500)}else{u.$hide()}};u.$show=function(){console.log("notify >>> show");if(z.hasClass("ns-effect-slide")&&z.hasClass("ns-bottomright")){z.css({bottom:"-"+z.outerHeight()+"px"})}else{z.css("opacity",1).attr("data-closing","false")}u.$state=true;z.removeClass("ns-hide").addClass("ns-show")};u.$hide=function(){console.log("notify >>> hide");if(z.hasClass("ns-effect-slide")&&z.hasClass("ns-bottomright")){z.css({bottom:"-"+z.outerHeight()+"px"})}else{z.css("opacity",0).attr("data-closing","true")}u.$state=false;z.removeClass("ns-show").addClass("ns-hide")};u.$bindFullHTML=function(B){return i.trustAsHtml(B)};var A=function(){var E=0;var C=t.startTop;for(var G=0;G<j.length;G++){var D=10;var F=j[G];var B=F[0].offsetHeight;var H=C+B+D;if(F.attr("data-closing")){}else{C+=B+l}F.css("top",H+"px").css("margin-top","-"+(B+D)+"px").css("visibility","visible");E++}};if(!t.single){q(function(){A()})}if(!t.persistent&&t.duration>0){q(function(){u.$close()},t.duration)}}).error(function(w){throw new Error("Template specified for cgNotify ("+t.templateUrl+") could not be loaded. "+w)});var v={};v.close=function(){console.log("kaboom");if(u.$close){u.$close()}};v.show=function(){if(u.$show){u.$show()}};v.hide=function(){if(u.$hide){u.$hide()}};v.getState=function(){return u.$state};Object.defineProperty(v,"message",{get:function(){return u.$message},set:function(w){u.$message=w}});return v};g.config=function(t){b=!angular.isUndefined(t.startTop)?t.startTop:b;l=!angular.isUndefined(t.verticalSpacing)?t.verticalSpacing:l;a=!angular.isUndefined(t.duration)?t.duration:a;k=t.templateUrl?t.templateUrl:k;s=!angular.isUndefined(t.position)?t.position:s;h=t.container?t.container:h;o=t.classes?t.classes:o;m=t.persistent?t.persistent:m;c=t.closable?t.closable:c;f=t.toggleable?t.toggleable:f};g.closeAll=function(){for(var u=j.length-1;u>=0;u--){var t=j[u];t.css("opacity",0);t.removeClass("ns-show").addClass("ns-hide");q(function(){t.remove()},500)}};return g}]);